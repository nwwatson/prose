<% content_for(:title) { t('admin.passkeys.index.title') } %>

<div class="max-w-4xl">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold text-gray-900"><%= t('admin.passkeys.index.title') %></h1>
  </div>

  <%# Register form %>
  <div class="mb-8 rounded-lg border border-gray-200 bg-white p-4" data-controller="passkey">
    <h2 class="text-sm font-medium text-gray-700 mb-3"><%= t('admin.passkeys.index.register_new') %></h2>
    <p data-passkey-target="error" class="hidden mb-3 rounded-md bg-red-50 p-3 text-sm text-red-800"></p>
    <div class="flex items-end gap-3">
      <div class="flex-1">
        <label for="passkey_name" class="block text-sm text-gray-600 mb-1"><%= t('admin.passkeys.index.passkey_name') %></label>
        <input type="text" id="passkey_name" data-passkey-target="nameInput" placeholder="<%= t('admin.passkeys.index.passkey_name_placeholder') %>" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
      </div>
      <button type="button" data-action="passkey#register"
              class="rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 cursor-pointer">
        <%= t('admin.passkeys.index.register_passkey') %>
      </button>
    </div>
  </div>

  <%# Passkey list %>
  <% if @passkeys.any? %>
    <div class="overflow-hidden rounded-lg border border-gray-200 bg-white">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"><%= t('admin.passkeys.index.name') %></th>
            <th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"><%= t('admin.passkeys.index.registered') %></th>
            <th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"><%= t('admin.passkeys.index.last_used') %></th>
            <th class="px-4 py-3"></th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <% @passkeys.each do |passkey| %>
            <tr>
              <td class="px-4 py-3 text-sm font-medium text-gray-900"><%= passkey.name %></td>
              <td class="px-4 py-3 text-sm text-gray-500"><%= passkey.created_at.strftime("%b %d, %Y") %></td>
              <td class="px-4 py-3 text-sm text-gray-500">
                <%= passkey.last_used_at ? time_ago_in_words(passkey.last_used_at) + " " + t('shared.ago') : t('shared.never') %>
              </td>
              <td class="px-4 py-3 text-right text-sm">
                <%= button_to t('admin.passkeys.index.remove'), admin_passkey_path(passkey), method: :delete,
                      class: "text-red-600 hover:text-red-800 text-sm font-medium",
                      data: { turbo_confirm: t('admin.passkeys.index.remove_confirm') } %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="text-sm text-gray-500"><%= t('admin.passkeys.index.no_passkeys') %></p>
  <% end %>
</div>
