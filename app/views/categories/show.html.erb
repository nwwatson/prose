<% content_for(:title, page_title(@category.name)) %>

<% content_for(:head) do %>
  <% cat_description = @category.description.presence || "Browse posts in #{@category.name}" %>
  <%= meta_description_tag(cat_description) %>
  <%= open_graph_tags(title: "#{@category.name} — #{site_name}", description: cat_description, url: category_url(@category, slug: @category.slug)) %>
  <%= twitter_card_tags(title: "#{@category.name} — #{site_name}", description: cat_description) %>
  <%= canonical_tag(category_url(@category, slug: @category.slug)) %>
  <%= json_ld_tag({ "@context": "https://schema.org", "@type": "CollectionPage", name: @category.name, description: cat_description, url: category_url(@category, slug: @category.slug) }) %>
<% end %>

<div>
  <h1 class="font-display text-3xl font-bold"><%= @category.name %></h1>
  <% if @category.description.present? %>
    <p class="mt-2 text-gray-600 dark:text-gray-400"><%= @category.description %></p>
  <% end %>
</div>

<div class="mt-8 space-y-8">
  <% @posts.each do |post| %>
    <article class="border-b border-gray-200 dark:border-gray-700 pb-8">
      <h3 class="font-display text-2xl font-bold">
        <%= link_to post.title, post_path(post, slug: post.slug), class: "text-charcoal hover:text-ink-blue transition-colors no-underline" %>
      </h3>
      <div class="mt-2 flex items-center space-x-3 text-sm text-gray-500 dark:text-gray-400">
        <span>By <%= author_link(post.user) %></span>
        <span>&middot;</span>
        <time datetime="<%= post.published_at.iso8601 %>"><%= post.published_at.strftime("%B %-d, %Y") %></time>
      </div>
    </article>
  <% end %>
</div>
